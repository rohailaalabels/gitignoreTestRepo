<style>
.editor-lead-section {
	padding: 20px 10px !important;
}
.lba-choose-other-design-btn {
	border: #666666 solid 2px;
	background: transparent;
	color: #333;
	font-weight: bold;
	-webkit-transition-duration: 0.4s;
	transition-duration: 0.4s;
}
.lba-choose-other-design-btn:hover {
	border: #333 solid 2px;
	background: #333;
	color: #fff;
	font-weight: bold;
}
.lba-checkout-btn {
	float: right;
	font-weight: bold;
	-webkit-transition-duration: 0.4s;
	transition-duration: 0.4s;
}
.lba-checkout-btn:hover {
	background-color: #fb3b01 !important;
	color: #fff !important;
	border: 1px solid #fb3b01 !important;
}
.lba-nav-tabs li a {
	border-radius: 0px !important;
	background-color: #e0e0e0;
	padding: 10px 10px !important;
}
.LBAEditor .nav-tabs {
	float: left;
	border-bottom: 0;
}
.LBAEditor .nav-tabs li {
	float: none;
	margin: 0;
	border-left: 0;
}
.LBAEditor .nav-tabs li a {
	margin-right: 0;
	border: 0;
}
.LBAEditor .nav-tabs li a:hover {
	background-color: #17b1e3;
}
.LBAEditor .nav-tabs li:hover {
	border-color: #17b1e3;
}
.LBAEditor .nav-tabs .glyphicon {
	color: #fff;
}
.LBAEditor .nav-tabs .active .glyphicon {
	color: #333;
}
.LBAEditor .nav-tabs > li.active > a, .LBAEditor .nav-tabs > li.active > a:hover, .LBAEditor .nav-tabs > li.active > a:focus {
	border: 0;
	background: #00b6f0;
}
.LBAEditor .tab-content {
	margin-left: 0px;
}
.LBAEditor .tab-content .tab-pane {
	display: none;

	padding: 2.0rem;
	overflow-y: auto;
}
.LBAEditor .tab-content .active {
	display: block;
}
.lba-tab-pane {
	text-align: center;
}
.lba-hr {
	display: inline-table;
}
.lba-label-summary-wrapper {
	display: none;
}
.lba-label-summary-heading {
	text-align: center;
	border-bottom: #ccc solid 1px;
	border-top: #ccc solid 1px;
	margin: 10px 0px;
	padding: 5px 0px;
}
.lba-label-summary {
	font-size: 9px;
	border-bottom: #ccc solid 1px;
	padding: 5px 0px;
}
.lba-right-col {
}
.lba-supply {
	padding-bottom: 5px;
}
.editor-checkbox-wrapper label {
	margin-bottom: 0px !important;
	padding: 0;
}
.editor-checkbox {
	position: inherit !important;
	margin-right: 5px !important;
}
.lba-space {
	padding: 10px;
}
.lba-left-col {
	padding-left:7.5px !important;	
}
	
.gray-bg {
	background-color: #f1f2f2;
}
.bg-n-border-radius {
	border-radius: 5px;
	background-color: white;
	/*box-shadow: 0 4px 0 #848484;*/
	display: block;
	transition: border 0.2s ease-in-out;
	margin: 0;
}
.lba-thubmnail-image {
	width: 60px;
}
.no-padding {
	padding: 0 !important;
}
.aa-modal .panel-heading {
	background-color:#17b1e3 !important;
}
.labels-form .radio input + i::after {
	border-radius: 50%;
	content: "";
	height: 7px;
	left: 3px;
	top: 3px;
	width: 7px;
}
.bg-n-border-radius {
	//box-shadow: none;
}
.roll_prices {
	margin-bottom: 15px;
}
label.supply {
	cursor: pointer;
}
label.supply span {
	font-weight: normal;
}
.lba-editor-price {
	color: #fd4913;
	font-size: 18px;
	font-weight: bold !important;
}
label.supply:hover i {
	border-color: #8dc9e5;
}
.set_box {
	padding: 0;
}
.set_box .set_head {
	padding: 8px 15px;
	border-bottom: 1px solid #ececec;
}
.set_box .set_body {
	padding: 10px 0;
}
.well {
	margin: 0;
	border-radius: 0;
	padding: 10px;
}
span.summary-label {
	font-size: 11px;
	display: block;
}
.summmary-block {
	border-right: 1px solid #ececec;
	margin-bottom:10px;
}
.summmary-block:last-child {
	border: 0;
}
.lba-left-col {
	padding-left: 0;
}
.Thumbnails {
	background: #f5f5f5;
	width: 100%;
	border: 1px solid #cccccc;
	height: 255px;
	cursor: pointer;
	position: relative;
}
.middle {
	transition: .5s ease;
	opacity: 0;
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	-ms-transform: translate(-50%, -50%);
	text-align: center;
	background: rgba(255, 255, 255, 0.9);
	width: 100%;
	height: 100%;
	padding-top: 95px;
}
.middle a {
	background-color: #fd4913;
	color: white;
	font-size: 12px;
	font-weight: bold;
	padding: 5px 8px;
	border-radius: 5px;
}
.middle a:hover {
	text-decoration: none;
	background-color: #cb4213;
	transition: .5s ease;
}
.Thumbnails:hover .Thumbnails img {
	opacity: 0.3;
}

.Thumbnails:hover .middle {
	opacity: 1;
}
.Thumbnails h4 {
	padding: 10px 0;
	text-align: center;
	margin: 0;
	font-size: 12px !important;
	font-weight: bold;
}
.Thumbnails img {
   
 height: 100%;
    margin: 0 auto;
    width: auto;
    text-align: center;
    padding: 5px;
    object-fit: scale-down;
}
.Thumbnails p {
	text-align: center;
	padding: 10px 0;
	margin: 0;
}
.pr-title {
    font-size: 20px;
    color: #17b1e3;
    font-weight: bold;
    margin: 0 0 10px 0;
}
	.LBA-Btns {
		padding: 0;
	}
	.LBABG-Grey {
		padding-bottom: 0 !important;
	}
	.lba-ourTeam > div.thumbnail {
		margin-bottom: 10px;
	}
	.Margin-0 {
		margin: 0 !important;
	}
	.RelatedProducts {
		font-size: 24px !important;
		margin: 0 !important;
	}
	
.row_actions i
{
	font-size: 24px;
    color: #929292;
    padding-left: 25px;
}
.edit-adjst-design{
    padding: 3px 0px !important;
    
}
.design_thumbnail img
{
    width: 50px;
    float: left;
    margin-right: 10px;
}
span.design_name
{
	margin-top: 9px !important;
    display: block;
}
#saved_designs table tr td, #saved_designs table tr th {
    vertical-align: middle !important;
    border: 0;
    border-bottom: 1px solid #ddd;
}
@media only screen and (max-width: 600px) {
    .sign-in-popup {
        width:auto !important;
    }
}
</style>
<!-- new css -->
<style>
.more-sizes-link
{
	max-height: 150px !important;
	height: 150px;
}
.modal_trigger_p
{
	padding-left: 3px !important;
    padding-right: 3px !important;
    text-decoration: underline;
}
.more_sizes .close
{
	position: absolute;
    right: -6px;
    top: -8px;

}
.more_sizes .close i
{
	color:#17b1e3;
}
.scroll_div
{
	max-height:540px;
	overflow-y:auto;
}
.scroll_div .thumbnail {
    box-shadow: none !important;
    background: #f5f5f5;
} 

#add_cart_design, #select_design_panel .lba-space
{
	height:370px;
}
#add_cart_design
{
	background: #f3f3f3;
}
#add_cart_design img {
    margin: 0 auto;
}
.image_description {
    padding-left: 0px;
	margin-top:40px;
}
.image_description p{
    margin:0;
}
.image_description p strong{
    font-size:16px;
    color: #17b1e3;
	margin-bottom: 2px !important;
    display: block;
}

.image_thumbnail_cover img
{
	height:150px;
	margin:0 auto;
	margin-bottom:10px;
}
.confirm_btn_style {
	padding-left: 36px !important;
	padding-right: 36px !important;
}
.bullet_point_fldt {
    line-height: normal;
	margin-left: 10px !important;
}
.bullet_point_fldt i {
    color: #fd4913;
    margin-right: 5px;
}
</style>
<div id="aa_loader" class="white-screen" style="display:none;" >
  <div class="loading-gif text-center" style="top:50%; z-index:150;"><img onerror='imgError(this);' src="<?=Assets?>images/loader.gif" class="image" style="width:160px; height:43px; "> </div>
</div>
<div class="container m-t-b-8">
  <div class="row">
    <div class="col-xs-12 col-sm-6 col-md-8">
      <ol class="breadcrumb  m0">
        <li><a href="<?=base_url()?>"><i class="fa fa-home"></i></a></li>
        <li class="active"><a href="<?=base_url()?>free-label-design-templates/">Free Label Design Templates</a> / <a href="<?=base_url()?>free-label-design-templates/<?=$category->link?>">
          <?=$category->name?>
          </a> / <a href="<?=base_url()?>free-label-design-templates/<?=$category->link?>/<?=strtolower(str_replace(" ","-",str_replace("&","and",$category->sub_name)))?>">
          <?=$category->sub_name?>
          </a> /
          <?=$designID?>
        </li>
      </ol>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4"> </div>
  </div>
</div>

<? $is_logged = $this->session->userdata('logged_in'); ?>

<div class="bgGray LBAEditor" style="padding:5px 0px !important;">
<div class="container">
  <div id="select_design_panel"> </div>
   <div id="upper_panel">
     <? //include('lba_cart.php');?>
   </div>
  
  
   <div id="recommend_panel"> 
   <?  if($is_logged=="true"){ include('lba_recomend.php'); } ?></div>
  
  <div id="middle_panel">
   <? include('lba_labels.php');?>
  </div>
  
</div>
</div>




<div class="bgGray lba-top-padding LBA-Btns hide">
  <div class="container">
  <div class="row">	
	    <div class="col-md-12">
          <div class="thumbnail" style="padding:15px 0px 0px 0px;">
	      <div class="col-md-6"><a href="<?=base_url()?>lba-page/" data-role="button" class="btn col-lg-6 col-md-6 col-xs-8 lba-choose-other-design-btn">Choose a different design</a></div>
	      <div class="col-md-6"><a type="button" id="" href="<?=base_url()?>transactionregistration.php" class="btn orangeBg col-lg-6 col-md-6  lba-checkout-btn">Checkout</a></div>
          </div>
	    </div>
    </div>
  </div>
</div>




<? include('lba_slider.php');?>




<div class="printed-lba-call" style="border:none;background-color: white;">
  <div class="container " >
    <div class="col-md-8 col-sm-12 col-lg-9">
      <h2>INFORMATION & ADVICE <br /></h2>
     <p class="text-justify">These high quality labels designs have been  produced to be easily adapted and  personalised for your product labels via the choice of text, font, colour and size in the text boxes.  Along with your choice of logo and icons to be used in the label designs. Enabling you to quickly create and receive product labels with a professional image, enhancing the packaging and  promoting the product.
 </p>
  <p class="text-justify">If you need any assistance in choosing a label design and size for your needs or using the label editing features, please refer to our help guide or contact our customer care team using the live-chat facility on the page, our website contact form, email or telephone who will be happy to help you.</p>
    </div>
    <div class="col-md-4 col-sm-12 col-lg-3"> <img onerror='imgError(this);' class="img-responsive" src="<?=Assets?>images/header/call_opr_1.png"> </div>
  </div>
</div>

<style>
.modal-body {
  padding: 0px !important;
}
</style>



<!-- AA30 STARTS -->
<!-- 
<div class="modal fade login-modal aa-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-md sign-in-popup" style="width:26%">
    <div class="modal-content no-padding">
      <div class="panel no-margin">
        <div class="panel-heading">
          <h3 class="pull-left no-margin"><b id="lba_model_head">Account Login</b></h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fa fa-times-circle"></i></button>
          <div class="clear"></div>
        </div>
        <div class="panel-body">
          <div id="login_register_msg">You must login to your account before proceeding.</div>
          <div class="login_form">
            <form class="labels-form" id="login_form" method="post" action="">
              <input type="hidden" name="page" value="lba" />
              <div class="m-t-15">
                <div class="p-l-r-10">
                  <label id="server_error" style=" display:none;" class="error" ></label>
                  <div class=" ">
                    <label class="input"> <i class="icon-append fa fa-user"></i>
                      <input type="email" placeholder="Enter Email address" name="email" id="email" class="required">
                    </label>
                  </div>
                  <div class=" ">
                    <label class="input"> <i class="icon-append fa fa-lock"></i>
                      <input type="password" placeholder="Enter Password" name="password" id="password" class="required">
                    </label>
                  </div>
                  <div class="">
                    <button style="margin:13px 0; " type="submit" class="btn orangeBg  text-uppercase btn-block">Sign in </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="register_form" style="display:none;">
            <form class="labels-form " id="signup_form"  method="post" action="" >
              <div class=" m-t-b-10 ">
                <div>
                  <div class="col-sm-12">
                    <div class="col-md-12  ">
                      <label class="input"><i class="icon-append fa fa-user"></i>
                        <input type="text" name="firstname" id="firstname" placeholder="First Name" class="required">
                      </label>
                    </div>
                    <div class="col-md-12  ">
                      <label class="input"><i class="icon-append fa fa-user"></i>
                        <input type="text" id="lastname" name="lastname" placeholder="Last  Name" class="required">
                      </label>
                    </div>
                    <div class="col-sm-12  " >
                      <label class="input"> <i class="icon-append fa fa-envelope-o"></i>
                        <input type="email" placeholder="Email Address  (Your email address will be your log in ID)" name="email_reg" id="email_reg">
                      </label>
                    </div>
                    <div class="col-sm-12  " >
                      <label class="input"><i class="icon-append fa fa-lock"></i>
                        <input type="password" placeholder="Password" name="password_reg" id="password_reg">
                      </label>
                    </div>
                    <div class="col-sm-12  " >
                      <label class="input"> <i class="icon-append fa fa-lock"></i>
                        <input type="password" placeholder="Confirm Password " name="cpassword" id="cpassword">
                      </label>
                    </div>
                  </div>
                  <div class="col-sm-12">
                    <div class=" col-sm-12   ">
                      <button type="submit" id="activate-step-2" class="btn orangeBg text-uppercase btn-block"> Register Now </button>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <a type="button" class="forgot_password pull-left modal-footer-anchor">Forgot Password?</a>
          <a type="button" class="register_new pull-right modal-footer-anchor">Register a new account</a>
          <a type="button" class="login_new modal-footer-anchor" style="display:none;">Login To Account</a>
        </div>
      </div>
    </div>
  </div>
</div>
 -->
 <!-- AA30 ENDS -->

<div class="modal barcode-modal aa-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" >
  <div class="modal-dialog modal-md">
    <div class="modal-content no-padding">
      <div class="panel no-margin">
      <div class="panel-heading">
          <h3 class="pull-left no-margin"><b id="lba_model_head">Generate QR and Barcode</b></h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fa fa-times-circle"></i></button>
          <div class="clear"></div>
        </div>
        <div class="panel-body">
           <? include(APPPATH.'/views/lba/barcode.php');?>
           <style>
		   .prLbSteps-nav {
	/* background: #fff; */
	border-radius: 4px;
	color: #444;
	margin-bottom: 2em;
	overflow: hidden;
	box-shadow: 0 1px 0 #848484;
	padding-left: 35px;
	border: 1px solid;
}

		   </style>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade more_sizes aa-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content no-padding">
      <div class="panel no-margin">
        <div class="panel-heading hide">
          <h3 class="pull-left no-margin"><b>Label Layout</b></h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fa fa-times-circle"></i></button>
          <div class="clear"></div>
        </div>
        <div class="panel-body">
          <h3 class="pull-left"><b>More Shapes and Sizes</b></h3>
          <div class="clear"></div>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fa fa-times-circle"></i></button>
          <p>Browse the additional range of label shapes and sizes available to select and use with your chosen design. Once selected our studio designers will work on the design placement and you will receive an email link when the design ready for you customise.</p>
          <div class="scroll_div">
            <div id="ajax_more_sizes"> </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
.modal-footer .modal-footer-anchor {
	cursor: pointer;
	color: #17b1e3 !important;
	padding: 12px;
	font-weight: bold;
	font-size: 13px;
	font-family: arial;
}

</style>

<script>


/*$(document).on("click", ".edit_design", function(e) {
  var label_id = $(this).attr('data-label-id'); 
  var is_user_design_selected = $(this).attr('data-selected'); 
    $.ajax({
		url: base+'home/load_flash_panel',
		type:"POST",
		async:"false",
		dataType: "html",
		data:{label_id:label_id,is_user_design_selected:is_user_design_selected},
		success: function(data){
		if(data){
		 if(data=="login"){
		  $("a.login_new").trigger("click");	
		  $('.login-modal').modal('show');
		 }else{
		  $('#edited-label').val(label_id);
		  $('#design-selected').val(is_user_design_selected);
		  $('#upper_panel').html(data);
		  $("html, body").animate({ scrollTop: 250 }, "slow");
		 }
		}
	   }  
	});
 });*/
 
 function ajax_email_abandon_cart(label_id){
	 $('#edited-label').val(label_id);
     var labelid = $('#edited-label').val();
	 var is_user_design_selected = $('#design-selected').val();
     $.ajax({
			url: base+'home/ajax_email_abandon_cart',
			type:"POST",
			async:"false",
			dataType: "html",
			data:{label_id:label_id,is_user_design_selected:is_user_design_selected},
			success: function(data){
			if(data){
			 data = $.parseJSON(data); 
			 if(data.response=="login"){
			  $("a.login_new").trigger("click");	
			  $('.login-modal').modal('show');
			 }else{
			  $('#upper_panel').html(data.upper_panel);
			  $('#recommend_panel').html(data.recommend_panel);
			 }
			}
		   }  
		});
  }
		$(document).ready(function(){
	      var form = $("#login_form");
		  form.validate({ errorPlacement: function errorPlacement(error, element) { element.after(error); },
		  submitHandler: function(form) {
			  $("#login_form .btn").attr("disabled","disabled").html("Please Wait <i class='fa fa-spin fa-spinner'></i>");
			  	$.post(base+'ajax/user_login', $("#login_form").serialize(), function(data) {
					$("#login_form .btn").removeAttr("disabled").html("Submit Now <i class='fa fa-arrow-circle-right'></i>");
						 if(data.response=='error'){
							$('#server_error').text("Email address or password is invalid!");
							$('#server_error').show();
						 }else{
							update_header_login(data.username);
							$('.login-modal').modal('hide');
							
							var userid = data.userid;
							document.getElementById("Source").start_saving(userid);
							
							<? if(isset($directid) && $directid!=""){ 
                                if(isset($directselect) && $directselect == "true"){?>
                                ajax_email_abandon_cart(<?=$directid?>);
	                        <? } }else{ ?>
							if(data.template !=''){
							  //$("[data-label-id='"+data.template+"']").trigger("click");	
							}
						  <? } ?>	
					   }
						//swal("Alright!", "invalid login details", "success");  
						return false;   
				},'json');
					   
			return false;
	   }
	});
	

   		var form2 = $("#signup_form");
		form2.validate({ errorPlacement: function errorPlacement(error, element) { element.after(error); },
		rules: {
				password_reg: {
					required: true,
					minlength:8,
					maxlength:20,
				},
				cpassword: {
				  equalTo: "#password_reg"
				},
				 email_reg: {
				 required: true,
				 email: true,
				 onkeyup: false,
				 remote: base+"ajax/is_email_exist"
				}
			},
			messages: {
			 email_reg: {
					remote: $.validator.format("This email address is already taken.")
				}
					
			},
			submitHandler: function(form2) {
				$("#signup_form .btn").attr("disabled","disabled").html("Please Wait <i class='fa fa-spin fa-spinner'></i>");
				var reg_data = {
					'firstname':$("#firstname").val(),
					'lastname':$("#lastname").val(),
					'email':$("#email_reg").val(),
					'password':$("#password_reg").val(),
					'cpassword':$("#cpassword").val(),
					'page':'lba',
				};
				
				$.post(base+'users/signup', reg_data, function(data) {
					data = $.parseJSON(data);
					if(data.msg == "registered"){
						update_header_login($("#firstname").val());
						$('.login-modal').modal('hide');
						if(data.template !=''){
						 $("[data-label-id='"+data.template+"']").trigger("click");	
						}
					}
				},'html');
				return false;
				}
				
			});
			
	
	
	$("a.register_new").click(function(){
		$(".login_form").hide();
		$(".register_new").hide();
		$(".forgot_password").hide();
		$(".register_form").show();
		$(".login_new").css('display','block');
		$("#lba_model_head").html('Create Account');
		
		
	});
	
	$("a.login_new").click(function(){
		$(".login_form").show();
		$(".register_new").show();
		$(".forgot_password").show();
		$(".register_form").hide();
		$(".login_new").css('display','none');
		$("#lba_model_head").html('Account Login');
	});
	$("a.forgot_password").click(function(){
		window.location = base+"users/forgotpassword";
	});
});	
	
	
	

$(document).on('click','#triger',function(e){
	var productID = $(this).data('productid');
	var categoryID = $(this).data('cid');
	var size = $(this).data('size');
	var shape = $(this).data('shape');
	var thumbnail = $(this).data('thumbnail');
	var available_in = $(this).data('available_in');
	var association = $(this).data('association');
	var labelspersheet = $(this).data('labelspersheet');
	var label_id = $(this).data('labelid');
	var isselected = $(this).data('selected'); 
	
	$(".lba-label-summary-wrapper").find(".lba-label-summary .association").text(association);
	$(".lba-label-summary-wrapper").find(".lba-label-summary .categoryID").text(categoryID);
	$(".lba-label-summary-wrapper").find(".lba-label-summary .size").text(size);
	$(".lba-label-summary-wrapper").find(".lba-label-summary .shape").text(shape);
	
	$(".lba-label-summary-wrapper").find("#shape").val(shape);
	$(".lba-label-summary-wrapper").find("#association").val(association);
	$(".lba-label-summary-wrapper").find("#categoryID").val(categoryID);
	$(".lba-label-summary-wrapper").find("#available_in").val(available_in);
	$(".lba-label-summary-wrapper").find("#labelspersheet").val(labelspersheet);
	$(".lba-label-summary-wrapper").find("#size").val(size);
	$(".lba-label-summary-wrapper").find("#label_id").val(label_id);
	$(".lba-label-summary-wrapper").find("#isselected").val(isselected);
	
	thumbnail = '<?=Assets?>images/lba/'+thumbnail;
	$(".selected_thumbnail").attr('src',thumbnail);
	$('.productdetails').find('.add_to_cart_wrapper').hide();
	$('.productdetails').find('.calculate_button_wrapper').show();
	$('.productdetails').find('#printedsheet_input').focus();
  });
  
  
var timer = '';
function show_faded_popover(_this, text){
		$(_this).attr('data-content','');
		$(_this).popover('hide');
		$(_this).popover('destroy');
		$(_this).popover({'placement':'top'});
		$(_this).attr('data-content',text);
		$(_this).popover('show');
		clearTimeout(timer);
		timer = setTimeout(function(){ 
				$(_this).attr('data-content','');
				$(_this).popover('hide');
				$(_this).popover('destroy');
		}, 5000);
}

function is_numeric(mixed_var) {
    var whitespace =
    " \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000";
    return (typeof mixed_var === 'number' || (typeof mixed_var === 'string' && whitespace.indexOf(mixed_var.slice(-1)) === -1)) && mixed_var !== '' && !isNaN(mixed_var);
}

$(document).on("click", ".calculate_printed", function(e) {
	var menuid =  $.trim($(this).parents('.productdetails').find('#productID').val());
	var categoryID =  $(this).parents('.productdetails').find('#categoryID').val();
	var association =  $(this).parents('.productdetails').find('#association').val();
	var available_in =  $(this).parents('.productdetails').find('#available_in').val();
	var labelspersheet =  $(this).parents('.productdetails').find('#labelspersheet').val();
	var labeltype = '4 Colour Digital Process';
	var isselected =  $(this).parents('.productdetails').find('#isselected').val();
	$('.add_to_cart').addClass('disabled');
	
	if(isselected=="false"){
	 swal('Please Edit Design First');
	 return false;
	}
	
	if(available_in=="both"){
	  $('.add_to_cart').css('top','0px');
	}else{
	 $('.add_to_cart').css('top','22px');
	}
	
	var min_qty = 50;
	var max_qty = 500000;
	var labels = labelspersheet;
	var unitqty =  'Labels';
	var material_adhesive = $(this).parents('.productdetails').find('#material_adhesive').val();
	var input_id = $(this).parents('.productdetails').find('.printedsheet_input');
	var _this = this;
	if(material_adhesive == '')
	{
		swal('Please Select Material & Adhesive');
		$("#material_adhesive").css({'border-color':'red'});
		return false;
	}
	$("#material_adhesive").css({'border-color':'#e5e5e5'});
	var qty =  input_id.val();
	var _this = this;
	if(unitqty == 'Labels'){
		 //var min_qty = parseInt(labels)*min_qty;
		 //var max_qty = parseInt(labels)*max_qty;
	}
	if(!is_numeric(qty) || qty=='' || qty < min_qty){
		   input_id.val(min_qty);
	       show_faded_popover(input_id, 'Quantity has been amended for production as '+min_qty+' labels.');
	}
	else if(qty > max_qty){
			input_id.val(max_qty);
			show_faded_popover(input_id, 'Quantity has been amended for production as '+max_qty+' labels.');
	}
	else{
		if(qty%labels != 0 && unitqty == 'Labels'){
				var multipyer = parseInt(labels) * parseInt(parseInt(qty/labels)+1);
				//input_id.val(multipyer);
				//var qty = multipyer;
		}
		
		if(unitqty == 'Labels'){
			//qty = parseInt(qty/labels);
		}
		
		$("#aa_loader").show();
		menuid=menuid+material_adhesive;
		$.ajax({
				url: base+'ajax/calculate_lba_prices',
				type:"POST",
				async:"false",
				dataType: "html",
				data:{
					menuid:menuid,
					qty: qty,
					labels: labelspersheet,
					material_adhesive:material_adhesive,
					labeltype:labeltype,
					categoryID:categoryID,
					available_in:available_in,
					association:association,
					},
				success: function(data){
				if(!data==''){	
					data = $.parseJSON(data); 
					if(data.response=='yes'){
					$('#freedeliveryuk').hide();
					$('#after_freedeliveryuk').show();
					if(data.rollprices == "")
						{
							$(_this).parents('.productdetails').find('.roll_prices').hide();
							$(_this).parents('.productdetails').find('.roll_prices_more').hide();
						}
						 else if(data.rollprices == "noresult")
						{
							$(_this).parents('.productdetails').find('.roll_prices').hide();
							$(_this).parents('.productdetails').find('.roll_prices_more').show();
							
							
							var qty_to_show = data.min_qty_die;
							if(multipyer > data.min_qty_die)
							{
								qty_to_show = multipyer;
							}
							
							$('.add_to_cart').css('margin-bottom','3px');
							$(_this).parents('.productdetails').find('.roll_prices_more').find('.min_qty_die').text(qty_to_show);
						}
						else
						{
							data.rollprices = $.parseJSON(data.rollprices);
							$(_this).parents('.productdetails').find('.roll_prices').show();
							$(_this).parents('.productdetails').find('.roll_prices_more').hide();
							$(_this).parents('.productdetails').find('.roll_prices .lba-editor-price').html(data.symbol+data.rollprices.rawprice);
							$(_this).parents('.productdetails').find('.roll_prices .vatoption').text(data.vatoption);
							$(_this).parents('.productdetails').find('.roll_prices .labelprice').html(data.rollprices.labelprice);
							$(".roll_data").find(".rawprice").val(data.rollprices.rawprice);				
							$(".roll_data").find(".ManufactureID").val(data.ManufactureID_roll);				
							$(".roll_data").find(".ProductID").val(data.ProductID_roll);				
							$(".roll_data").find(".max_labels").val(data.MaxLabels_roll);	
							$(".roll_data").find(".category_description").val(data.category_description_roll);			
						}
						if(data.sheetprices == "")
						{
							$(_this).parents('.productdetails').find('.sheet_prices').hide();
						}
						else
						{
							data.sheetprices = $.parseJSON(data.sheetprices);
						    $(_this).parents('.productdetails').find('.sheet_prices').show();
							$(_this).parents('.productdetails').find('.sheet_prices .lba-editor-price').html(data.symbol+data.sheetprices.rawprice);
							$(_this).parents('.productdetails').find('.sheet_prices .vatoption').text(data.vatoption);
							$(_this).parents('.productdetails').find('.sheet_prices .labelprice').html(data.sheetprices.labelprice);
							$(".sheet_data").find(".rawprice").val(data.sheetprices.rawprice);
							$(".sheet_data").find(".ManufactureID").val(data.ManufactureID_sheet);
							$(".sheet_data").find(".ProductID").val(data.ProductID_sheet);
							$(".sheet_data").find(".max_labels").val(data.MaxLabels_sheet);
							$(".sheet_data").find(".category_description").val(data.category_description_sheet);	
						}
						$(_this).parents('.productdetails').find('.calculate_button_wrapper').hide();
						$(_this).parents('.productdetails').find('.add_to_cart_wrapper').show();
						$("input[name='add_option']").attr('checked', false);
						if(data.rollprices == "noresult")
						{
							$("input[value='Sheets']").prop("checked",true);
							$('.add_to_cart').removeClass('disabled');
						}
						
						$("#aa_loader").hide();
						}
					}
				 }
			});
	  }
});

$(document).on('focus','.printedsheet_input',function(e){
	$(this).parents('.productdetails').find('.add_to_cart_wrapper').hide();
	$(this).parents('.productdetails').find('.calculate_button_wrapper').show();
	$('#freedeliveryuk').show();
	$('#after_freedeliveryuk').hide();
	
});
$(document).on('change','#material_adhesive',function(e){
	$(this).parents('.productdetails').find('.add_to_cart_wrapper').hide();
	$(this).parents('.productdetails').find('.calculate_button_wrapper').show();
	$('#freedeliveryuk').show();
	$('#after_freedeliveryuk').hide();
});


$(document).on('click','#newslwtter_value',function(e){
       if($(this).prop("checked") == true){

               $('#newslwtter_div').removeClass( "lba_checked_border" );

            }
    
});

$(document).on('click','.add_to_cart',function(e){
	var label_id =  $(this).parents('.productdetails').find('#label_id').val();
	var product_type = $("input[name='add_option']:checked").val();
	var qty = parseInt($("#printedsheet_input").val());
	var category_description = "";
	var cart_data = {};
	
	var total_length = parseInt($(".designconfirmation:checked").length);
	if(total_length==0){
	 $('#newslwtter_div').addClass( "lba_checked_border" );
	 swal("Approval Needed","Please check the approval box to indicate that you approve this design.","warning");
	 
	 return false;
	}
		
	if(product_type == undefined)
	{
		swal("Please Select Option for Labels on Sheets or Rolls.");
		return false;
	}
	else if(product_type == "Rolls")
	{
		var ManufactureID_roll = $(".roll_data").find('.ManufactureID').val();
		var ProductID_roll = $(".roll_data").find('.ProductID').val();
		var rawprice_roll = parseFloat($(".roll_data").find('.rawprice').val());
		var max_labels_roll = $(".roll_data").find('.max_labels').val();
		category_description = $(".roll_data").find(".category_description").val();
		if(ManufactureID_roll == '' || rawprice_roll == '' || rawprice_roll == 0)
		{
			swal({
				  title: "Out of Stock",
				  text: "Sorry, this product is currently out of stock",
				  type: "warning",
				  showCancelButton: false,
				  confirmButtonClass: "btn orangeBg",
				  confirmButtonText: "OK",
				  closeOnConfirm: true,
				},
				function(isConfirm) {
				  if (isConfirm) {
				  } 
		 	});
			return false;
		}
		else
		{
		    cart_data.total_labels = qty; 
			cart_data.labels = qty;
			cart_data.menuid = ManufactureID_roll;
			cart_data.prd_id = ProductID_roll;
			cart_data.max_labels = max_labels_roll;
			cart_data.labelfinish = "No Finish";
			cart_data.printing = "6 Colour Digital Process";
			cart_data.presproof = "";
			cart_data.woundoption = "Outside";
			cart_data.orientation = 1;
			cart_data.type = "Rolls";
		}
	}
	else if(product_type == "Sheets")
	{
		var ManufactureID_sheet = $(".sheet_data").find('.ManufactureID').val();
		var rawprice_sheet = parseFloat($(".sheet_data").find('.rawprice').val());
		var ProductID_sheet = $(".sheet_data").find('.ProductID').val();
		var max_labels_sheet = $(".sheet_data").find('.max_labels').val();
		var category_description = $(".sheet_data").find(".category_description").val();
		var labels = $("#labelspersheet").val();
		
		if(ManufactureID_sheet == '' || rawprice_sheet == '' || rawprice_sheet == 0)
		{
			swal({
				  title: "Out of Stock",
				  text: "Sorry, this product is currently out of stock",
				  type: "warning",
				  showCancelButton: false,
				  confirmButtonClass: "btn orangeBg",
				  confirmButtonText: "OK",
				  closeOnConfirm: true,
				},
				function(isConfirm) {
				  if (isConfirm) {
				  } 
		 	});
			return false;
		}
		else
		{
		    cart_data.total_labels = qty; 
			cart_data.labels = max_labels_sheet;
			cart_data.qty = qty = Math.ceil(qty/labels);
			cart_data.menuid = ManufactureID_sheet;
			cart_data.prd_id = ProductID_sheet;
			cart_data.labeltype = "Fullcolour";
			cart_data.menuid = ManufactureID_sheet;
		}
	}
	cart_data.source = "LBA";
	cart_data.label_id = label_id;
	$.ajax({
		url: base+'ajax/add_products_incart',
		type:"POST",
		async:"false",
		dataType: "html",
		data: cart_data,
		success: function(data){
			if(!data==''){
				data = $.parseJSON(data); 
				if(data.response=='yes'){
					popup_messages('Printed Labels on '+product_type+' - '+category_description);
					$('#cart').html(data.top_cart);
					$('#recommend_panel').html(data.bottom_cart);
				}
			}
		}  
	});
});

   function update_header_login(username){
		var name = "<i class='fa fa-user'></i> Welcome "+username;
		$('#update_header').find(".userName").html(name);
		
		var dropdown = "<li class='MyAccount'><a href='<?=SAURL?>users/user_orders/'>Easy Re-Order</a></li>";
		dropdown += "<li class='ReOrder'><a href='<?=SAURL?>users/'>My Account</a></li>";
		dropdown += "<li class='LogOut'><a href='<?=SAURL?>users/logout/'>Logout</a></li>";
		$('.loginRegister').find("ul.dropdown-menu").html(dropdown);
	}



$(document).on("click", ".edit_design", function(e) {

 var label_id = $(this).attr('data-label-id'); 
 var is_user_design_selected = $(this).attr('data-selected'); 
 $('.lb_applications').modal('hide');	
 		
  if(document.getElementById("Source")!=null){
      swal({
		  title: "You are leaving the label editor page with unsaved designs, would you like to save for further editing upon your return or discard and start again?",
		  text: "",
		  type: "warning",
		  showCancelButton: true,
		  cancelButtonText: "RETURN AND SAVE",
		  confirmButtonClass: "btn orangeBg",
		  confirmButtonText: "CONTINUE WITHOUT SAVING",
		  closeOnConfirm: true,
		},
		function(isConfirm) {
		    if(isConfirm) {
			  load_panel_lba(label_id,is_user_design_selected,'yes');	
		    }else{ return false;	}
	     });
  
  }else{
	load_panel_lba(label_id,is_user_design_selected,'yes');	
   }
	$("#select_design_panel").hide();
	$("#upper_panel").show();
 });
 
   function load_panel_lba(label_id,is_user_design_selected,add){
	   $.ajax({
			url: base+'home/load_flash_panel',
			type:"POST",
			async:"false",
			dataType: "html",
			data:{label_id:label_id,is_user_design_selected:is_user_design_selected,add:add},
			success: function(data){
			if(data){
			    var data = $.trim(data);
			 if(data=="login"){
			  $("a.login_new").trigger("click");	
			  $('.login-modal').modal('show');
			 }else{
			  $('#edited-label').val(label_id);
			  $('#design-selected').val(is_user_design_selected);
			  $('#upper_panel').html(data);
			  $("html, body").animate({ scrollTop: 250 }, "slow");
			 }
			}
		   }  
		});
  }



	
 function update_lba_setpanel(labelid){ 
  $('#edited-label').val(labelid);
  var labelid = $('#edited-label').val();
  var is_user_design_selected = $('#design-selected').val();
     $.ajax({
		url: base+'home/lba_sets_data',
		type:"POST",
		async:"false",
		dataType: "html",
		data:{labelid:labelid,is_user_design_selected:is_user_design_selected},
		success: function(data){
		   if(!data==''){
				data = $.parseJSON(data); 
				if(data.response=='yes'){
					$('#upper_panel').html(data.upper_panel);
					$('#recommend_panel').html(data.recommend_panel);
				}
			}
	   }  
	});
 }
 
 
 


 function cart_panel(labelid,is_user_design_selected){
   $('#edited-label').val(labelid);
   $('#design-selected').val(is_user_design_selected);
   update_lba_setpanel();
 }	
 
 function open_qr_barcode_panel(){
  $('.barcode-modal').find('.bgGray').css('background', 'white' );
  $('.barcode-modal').find('.bgGray').css('padding', '0px' );
  $('.barcode-modal').find('.prLbSteps-nav').css('margin-bottom', '0em' );
  $('.barcode-modal').find('.thumbnail').css('box-shadow', '0px' );
  $('.barcode-modal').find('.thumbnail').css('padding-bottom', '0px' );
  $('.barcode-modal').find('.thumbnail').css('margin-bottom', '0px' );
  $('.barcode-modal').modal('show');
 }
 
  $(document).on('change','.productbrand',function() {
	var total_length = parseInt($(".productbrand:checked").length);
	if(total_length==1){
	 $('.add_to_cart').removeClass('disabled');
	}else{
	 $('.add_to_cart').addClass('disabled');
	}
 });
 
 $(document).on("click", ".delete_user_design", function(e) {
	 var id = $(this).attr('data-id');
	 swal({
		  title: "Are you sure you want to delete this design ?",
		  text: "",
		  type: "warning",
		  showCancelButton: true,
		  cancelButtonText: "No",
		  confirmButtonClass: "btn orangeBg",
		  confirmButtonText: "YES",
		  closeOnConfirm: true,
		},
		function(isConfirm) {
		    if(isConfirm) {
				$.ajax({
					url: base+'home/delete_user_design',
					type:"POST",
					async:"false",
					dataType: "html",
					data:{id:id},
					success: function(data){
					 if(!data==''){
						$('#user_des_'+id).remove();
					  }
					}  
				});
		      }
	     });
   });	 


var checkoutconfirm = false;
window.onload = function() {

window.addEventListener("beforeunload", function (e) {
if (checkoutconfirm) {
 return undefined;
}

 if(document.getElementById("Source")!=null){
var confirmationMessage = 'You are leaving this page with an incomplete design on the screen, would you like to save this for further editing or discard and start again on your return? ';
(e || window.event).returnValue = confirmationMessage; //Gecko + IE
  return confirmationMessage; //Gecko + Webkit, Safari, Chrome etc.
  
}
});


};

</script> 

<? if(isset($directid) && $directid!=""){ 

      if(isset($directselect) && $directselect == "true"){?>
       <script>
           ajax_email_abandon_cart(<?=$directid?>);
	  </script>
      <? }else{ ?>	   
       <script>
      //history.pushState(null, "", location.href.split("?")[0]);
          load_panel_lba(<?=$directid?>,<?=$directselect?>,'no');
     </script>
    <? } ?>
    
  
<? } ?>
<script type="text/javascript">
$(document).on("click",".trigger_modal",function(e){
	var designid = $(this).data('designid');
	var coverid = $(this).data('coverid');
	if(designid == '' || designid == 'undefined')
	{
		return false;
	}
	
	$('#aa_loader').show();	
	
	$.ajax({
		url: base+'ajax/get_more_sizes',
		type: "POST",
		async: "false",
		dataType: "html",
		data: { designid:designid},
		success: function(data){
			data = $.parseJSON(data);
			if(data.response == "yes")
			{
				$("#ajax_more_sizes").html(data.html);
				$(".more_sizes").modal("show");
				$('#aa_loader').hide();
				$("#currentdesignid").val(designid);
				$("#image_thumbnail_cover_hidden").val(coverid);
			}
			else
			{
				swal("No more sized available");
			}
		}
	});
});
$(document).on("click",".select_size",function(e){
	var designid = $("#currentdesignid").val();
	var brand = $(this).data('brand');
	var category = $(this).data('cat');
	var thumbnail_cover = $("#image_thumbnail_cover_hidden").val();
	if(designid == '' || designid == 'undefined')
	{
		return false;
	}
	$.ajax({
		url: base+'ajax/select_more_design',
		type: "POST",
		async: "false",
		dataType: "html",
		data: { designid:designid,brand:brand,category:category},
		success: function(data){
			data = $.parseJSON(data);
			if(data.response == "yes")
			{
				var thumbsrc = "<?=LABELER."thumb/"?>"+thumbnail_cover;
				$("#upper_panel").hide();
				$(".more_sizes").modal('hide');
				$("#select_design_panel").html(data.html);
				$("#select_design_panel").show();
				$(".image_thumbnail_cover").find('img').attr('src',thumbsrc);
				$("html, body").animate({ scrollTop: 250 }, "slow");
			}
			else
			{
				swal("No more sized available");
			}
		}
	});	
});
$(document).on("click",".add_to_cart_custom",function(e){
	
	var label_size = $(".lba_label_size").text();
	var label_shape = $(".lba_label_shape").val();
	var label_desc = $(".lba_label_text").text();
	
	var diecode = $("#diecode").val();
	var designid = $("#designid").val();
	var brand = $("#brand").val();
	var text_msg = "FLDT custom shape and size order "+label_size+" " + label_shape+ " with "+label_desc+" Design";
	
	$.ajax({
		url:base+'ajax/add_to_cart_design',
		type:'POST',
		data: {
			label_size: label_size,
			label_shape: label_shape,
			label_desc: label_desc,
			brand: brand,
			diecode: diecode,
			designid: designid,
		},
		success:function(data)
		{
			if(data.response == "yes")
			{
				$('#cart').html(data.topcart_data);
				swal({
				  title: 'Added to your basket',
				  text: text_msg+'.',
				  type: "success",
				  showCancelButton: true,
				  confirmButtonClass: "btn orangeBg confirm_btn_style",
				  confirmButtonText: "Checkout",
				  cancelButtonClass: "btn blueBg",
				  cancelButtonText: "Continue Shopping",
				  closeOnConfirm: true,
				  closeOnCancel: true
				 },
				function(isConfirm) {
					  if (isConfirm) {
						window.location.href = '<?=base_url()?>transactionregistration.php';
					  } else {
						return false;
					  }
				});
			}
			else
			{
			}
		}
	});
});

function check_user_login()
{
	$.ajax({
		url: base+'ajax/check_user_login',
		type:"POST",
		async:"false",
		dataType: "html",
		data:{},
		success: function(data)
		{
			if(data)
			{
				if(data=="login")
				{
					$("a.login_new").trigger("click");	
					$('.login-modal').modal('show');
				}
				else
				{
				    var userid = '<?=$this->session->userdata('userid')?>';
					document.getElementById("Source").start_saving(userid);
				}
			}
		}  
	});
}

$(document).ready(function(e) {
    <? $label_id = $this->input->get('label_id', TRUE);
	if(isset($label_id) and $label_id != ''):?>
	$('.edit_design[data-label-id=<?=$label_id;?>]').trigger("click");
	<? endif;?>
});

</script>